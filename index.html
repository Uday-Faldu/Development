<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home - E-Commerce</title>

    <script src="./components/Header/header.js"></script>
    <script src="./components/Footer/footer.js"></script>
    <script>
      loadHeader();
      loadFooter();

      document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");

        form.addEventListener("submit", function (e) {
          e.preventDefault();

          const username = form
            .querySelector('input[type="text"]')
            .value.trim();
          const password = form
            .querySelector('input[type="password"]')
            .value.trim();

          if (!username || !password) {
            alert("Please enter both username and password.");
            return;
          }

          const xhr = new XMLHttpRequest();
          xhr.open("POST", "https://dummyjson.com/auth/login", true);
          xhr.setRequestHeader("Content-Type", "application/json");

          xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 300) {
              try {
                const data = JSON.parse(xhr.responseText);
                if (data && data.id) {
                  localStorage.setItem("userData", JSON.stringify(data));

                  window.location.href = "./components/Home/home.html";
                } else {
                  alert(data.message || "Invalid username or password.");
                }
              } catch (err) {
                alert("Error parsing server response.");
              }
            } else {
              alert("Login request failed with status: " + xhr.status);
            }
          };

          xhr.onerror = function () {
            alert("Network error while trying to log in.");
          };

          xhr.send(
            JSON.stringify({
              username: username,
              password: password,
              expiresInMins: 30,
            })
          );
        });
      });
    </script>

    <style>
      .login-input::placeholder {
        color: #bdbdbd !important;
        opacity: 1;
      }
      .login-input {
        color: #333;
        border: none;
        border-bottom: 1px solid #bdbdbd !important;
        border-radius: 0;
        background: transparent;
        box-shadow: none;
      }
      .login-btn {
        font-weight: 600;
        width: 140px;
      }
    </style>
  </head>

  <body>
    <div id="header"></div>

    <main>
      <div class="container-fluid mt-5 mb-5">
        <div class="row align-items-center">
          <div class="col-12 col-md-7 mb-4 mb-md-0">
            <img src="/assests/Images/Side_Image.png" style="width: 100%" />
          </div>
          <div class="col-12 col-md-5">
            <div class="" style="height: 300px; width: 300px">
              <div class="h2 fw-bold mb-2">Log in to Exclusive</div>
              <div class="mb-4 text-secondary">Enter your details below</div>
              <form>
                <div class="mb-3">
                  <input
                    type="text"
                    class="form-control px-0"
                    placeholder="Email or Phone Number"
                    autocomplete="username"
                  />
                </div>
                <div class="mb-4">
                  <input
                    type="password"
                    class="form-control px-0"
                    placeholder="Password"
                    autocomplete="current-password"
                  />
                </div>
                <div
                  class="d-flex align-items-center justify-content-between mb-3"
                >
                  <button type="submit" class="btn btn-danger login-btn">
                    Log In
                  </button>
                  <a
                    href="#"
                    class="text-danger text-decoration-none fw-semibold"
                  >
                    Forget Password?
                  </a>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div id="footer"></div>
  </body>
</html>
